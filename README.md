# INSuRE - Malware Attribution Project

CyberAttack Attribution using Malware Artifacts

## Technical Details

Technical details can be found [here](https://git.io/JTURE)

## Team Members

Michael Tran, Kevin Chen, Alec Davila, Tu Van Nguyen

## Project Description
  
> Attribution of cyber-attacks is a critical, unsolved problem. Many markers of cyber-attack are unreliable, readily falsified, and transient. For many cyber-attacks, malware is an enduring artifact that can be used for attribution. Malware often comes as an executable file, which must conform to a specification in order to function properly. There is a great deal of metadata in executable files - such as when created, how many sections, what library calls are imported, etc. - that can be used as features for attribution analysis. Characteristics embedded in the malware executable provide artifacts of the attackers that created it. Malware is increasingly complex and heterogeneous, incorporating components from multiple sources and involving multiple actors, and attribution analysis must account for this complexity.

> In this project, our team developed a robust malware analysis pipeline with Python and some additional Bash scripts, enabling us to collect and analyze more than 100,000 samples of malware. We gathered static features embedded within the binaries themselves and dynamic features exhibited from execution inside a sandbox. We then tested several supervised machine learning classifiers on the collected features to identify which were most indicative of the family a piece of malware belongs to. Our pipeline was able to classify malware to their respective families with 85% accuracy. These results bring security researchers one step closer to being able to attribute unidentified pieces of malware to their real authors, using malware families as a proxy for authorship.

---

## Requirements

### General

```Rich Text Format
Python 3.6+
Anaconda 5.2+
```

### Development

```Rich Text Format
Git LFS 2.7.1+
```

---

## How to Run

### Data

**NOTE**: Before downloading the data, ensure that the `/data` folder is excluded from any scans from anti-virus software. If it is not, your anti-virus software will quarantine and/or delete the data.

To load the static and dynamic data, run the following command:

```Rich Text Format
python ./code/helpers/report_downloader.py -r "." -t "virustotal"
python ./code/helpers/report_downloader.py -r "." -t "cuckoo"
```

The following folders should appear in `/data`:

* /data/dynamic_cuckoo
* /data/static_vt

### Preprocessing Data

Run the following command:

```Rich Text Format
python ./code/MalwareAttribution/Preprocessing.py -d "data"
```

This will extract the features from static (Virus Total) and dynamic (Cuckoo) reports and nicely split the classes and features into `test_data.csv`, `train_data.csv` and `validate_data.csv`.

### Classifier

Run the following command:

```Rich Text Format
python ./code/MalwareAttribution/MalwareAttribution.py -d "data"
```

This will use the preprocessed data from the previous step and vectorize the data. It will then run leave-one-out experiments with 10-fold cross-validation.

Afterwards it will test the static and dynamic data using a Naive Bayes classifier, SVM classifier, and Bagging with Decision Tree base estimator Classifier.
